# 配置
**文档信息**

* **配置版本**：0
* **最后更新**：2025年12月15日

## 📍 服务器监听设置

| 配置项 | 默认值 | 说明与建议 |
| :--- | :--- | :--- |
| **服务器地址 (`ip`)** | `0.0.0.0:25565` | 服务器监听的主机和端口。`0.0.0.0` 表示接受来自任何网络接口（如公网、局域网）的连接。**如果您只想在本地电脑运行服务器供自己测试，可以改为 `127.0.0.1:25565`**。 |

## 🔐 玩家登录验证

| 配置项 | 默认值 | 说明与建议 |
| :--- | :--- | :--- |
| **正版验证 (`online_mode`)** | `true` (开启) | **这是最重要的安全设置之一。** 
• **开启 (`true`)**：玩家必须拥有正版《我的世界》账户才能进入。这是官方服务器的标准，最安全。
• **关闭 (`false`)**：允许任何玩家使用任意用户名进入（离线模式）。**警告：如果您将服务器公开到互联网，请务必了解关闭此选项带来的安全风险。** |

## 🔄 网络性能与代理

| 配置项 | 默认值 | 说明与建议 |
| :--- | :--- | :--- |
| **网络压缩阈值 (`network_compression_threshold`)** | `256` | 当服务器发送的数据包大于此值（单位：字节）时，会先压缩再发送，以节省网络带宽。如果您的服务器和玩家网络都很好，可以尝试调高（如 `512`）或设为 `-1` 来**完全禁用压缩**，以降低CPU消耗。 |
| **启用代理支持 (`proxy`)** | `false` (关闭) | **只有当您的 Qexed 服务器前方部署了 BungeeCord、Velocity 等“群组服”代理时才需要开启。** 开启后，服务器才能正确接收来自代理的真实玩家IP信息。 |

### 如果您开启了代理 (`proxy: true`)

您还需要设置以下两项：

| 配置项 | 默认值 | 说明与建议 |
| :--- | :--- | :--- |
| **代理协议类型 (`proxy_protocol`)** | `qtunnel` | 必须与您前方使用的**代理软件**保持一致，否则玩家无法连接！
• **`bungeecord`**：对应最常用的 BungeeCord。
• **`victory`**：对应 Velocity 代理。
• **`qtunnel`**：项目自定义协议。
• **`none`**：不使用任何代理协议（仅调试用）。 |
| **代理通信密钥 (`proxy_token`)** | (随机字符串) | 一个用于在服务器和代理之间进行安全验证的密码。**您必须将它复制到代理端（如BungeeCord）的配置文件中，确保两边完全一致**，否则连接会被拒绝。 |

## 🛡️ 连接安全防护

为了防止恶意攻击和刷连接，服务器内置了基础防护。

| 配置项 | 默认值 | 说明与建议 |
| :--- | :--- | :--- |
| **频率限制-时间窗 (`rate_limit_window_secs`)** | `60` 秒 | 统计连接频率的时间范围。 |
| **频率限制-最大次数 (`rate_limit_max_attempts`)** | `6` 次 | 在上述时间窗口内，允许同一个IP地址尝试连接的次数。超过次数的IP会被临时封禁。如果您遇到误封，可以适当调高这个数值。 |
| **状态查询超时 (`status_timeout_secs`)** | `5` 秒 | 玩家在服务器列表里“ping”您的服务器时，服务器响应的最长时间。如果网络较差导致列表刷不出，可以略微调大此值。 |

## ⚙️ 配置文件示例

一份典型的、用于**公开正版服**的配置可能如下所示：

```yaml
ip: "0.0.0.0:25565"
online_mode: true
network_compression_threshold: 256
proxy: false
# 当 proxy 为 false 时，以下 proxy_ 开头的设置无需理会
rate_limit_window_secs: 60
rate_limit_max_attempts: 10  # 稍微放宽了一点限制
status_timeout_secs: 5
```

一份用于**在 BungeeCord 后方**的子服务器配置可能如下：

```yaml
ip: "0.0.0.0:25566"  # 注意端口不能与BungeeCord或其他子服冲突
online_mode: false    # BungeeCord 已统一验证，子服关闭验证
proxy: true           # 关键：必须开启
proxy_protocol: bungeecord  # 关键：必须匹配
proxy_token: "MySecureSharedToken123"  # 关键：必须与BungeeCord配置一致
rate_limit_window_secs: 30
rate_limit_max_attempts: 30  # 因代理转发，限制可大幅放宽
```

## 📁 配置文件位置

此模块的配置文件通常位于服务器根目录的 `./config/qexed_player_list/` 文件夹中，名称可能为 `config.yaml`、`config.toml` 或 `config.json`，具体取决于项目设定的格式。

---

**总结**：对于大多数想开一个简单服务器的用户，您主要需要关注 **`ip`（端口）** 和 **`online_mode`（是否正版）** 这两个设置。只有当您需要搭建复杂群组服时，才需要深入了解代理相关的配置。


在 `qexed-one`中,为 [tcp_connect_app]